---
title: "Generate data"
author: "Jinane Jouni"
date: "2025-12-18"
output: html_document
---
# simulate series under different record models and save for later processing

# ----- 0. Setup ---------------------------------------------------
Let numbers display in decimals and not scientific notation
```{r options}
options(scipen = 999)
```

Set seed also
```{r set seed}
set.seed(12345)
```

Library Records is essential to run most of the functions available on github.

To install
```{r install Records}
## library Records from Github
#devtools::install_github("jj-64/Records")
```

Load Records
```{r load Records}
#library(Records)
devtools::load_all(".")
```
 
 
Check for required packages for install and loading
```{r install and load packages, message=FALSE, warning=TRUE, include=FALSE}
required_packages <- c(
  "tidyverse", "forecast", "e1071", "randomForest", "caret",
  "pROC", "glmnet", "nnet", "kernlab", "MASS", "car", "signal", "moments",
  "tsfeatures", "TSEntropies", "entropy",
  "feasts", "fabletools", "dplyr", "tibble", "stats"
)
## install if missing
install_if_missing(required_packages)

## Load libraries
load_package(required_packages = required_packages)

## Set caret parallel if desired (commented out by default)
library(doParallel)
# cl <- makeCluster(detectCores() - 1); registerDoParallel(cl)
```


# ----- 1. Build labeled feature_matrix of features ----------------

Option 1: Generate and create
the first option is to generate dataset and create feature matrix in one step.
We will save the simulated data (raw data) and feature matrix separately.
```{r option 1 to simulate data}
# simulated_data = generate_create_feature_dataset(n_per_model = 150,
#                                                  T_vals = c(100,150, 200),
#                                                  normalized = TRUE)
# raw_data = simulated_data$data
# feature_matrix  = as.data.frame(simulated_data$feature)
```

Option 2: Generate separately then create

The second option is to generate simulated data separately. "raw_data" is a large list file containing all series along with there identification labels.

          You must:
          1 - Specify the number of series per each of the four models.

          2 - Indicate the requested series length.

          3 - Choose if the series generated are to be normalized when generated (divided by max of each series)
```{r option 2 to generate data}
raw_data = generate_series_multiple(n_per_model = 100, T_vals = c(75, 100, 150), normalized = FALSE)
```

View data composition of underlying distribution:

```{r Raw data composition}
table(raw_data$labels, raw_data$labels_m)
```

We then execute the feature data set.

This may take a while depending on the raw data size.
```{r compute feature matrix}
feature_matrix  = as.data.frame(create_feature_dataset(raw_data))
```
look at a glimpse
```{r glimpse feature matrix}
head(feature_matrix, 1)
```

# ----- 2. Save ---------------------------------------------------

Save data in R project as database for ease of access later on.
```{r save data}
save(feature_matrix, file = "C:/Users/User/Documents/Records/data/feature_matrix.rda")
save(raw_data, file = "C:/Users/User/Documents/Records/data/raw_data.rda")
```

