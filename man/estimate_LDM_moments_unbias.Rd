% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/estimate_LDM_param.R
\name{estimate_LDM_moments_unbias}
\alias{estimate_LDM_moments_unbias}
\title{Bias-corrected estimator for theta in LDM (with optional variance)}
\usage{
estimate_LDM_moments_unbias(X, variance = TRUE, scale = 1)
}
\arguments{
\item{X}{Numeric vector. Observed series.}

\item{variance}{Logical. If TRUE (default) compute and return variance;
otherwise skip heavy computation.}

\item{scale}{Numeric. Scale parameter for the LDM (defualt = 1. theta is assumed to be in units such that
the user may pass scaled theta; internally we treat theta/scale).}
}
\value{
A list with elements:
\item{theta}{Bias-corrected estimate of \eqn{\theta}.}
\item{variance}{Asymptotic variance (or NA if variance = FALSE or could not be computed).}
}
\description{
Compute a bias-corrected estimate of \eqn{\theta} for the Linear Drift Model (LDM)
based on the number of records (NT) estimator in \code{\link{estimate_LDM_moments}},
and optionally compute the
asymptotic variance of the bias-corrected estimator.
If requested (variance = TRUE), it computes the variance \eqn{\vartheta(\theta)}
for the unbiased estimator of \eqn{\theta} in the LDM process.
}
\details{
The function calls the (unbiased) NT estimator routine "estimate_LDM_moments"
(which must return a list with \eqn{\theta} and optionally "variance"), applies the
analytical bias correction and — if requested — computes the variance using the
first order derivative formula and the variance of the original estimator.

The correction is computed based on the expected bias of the estimator.

The variance formula is given by:

\deqn{\vartheta(\theta) = \lambda(\theta) \left( \frac{d H_T(\theta)}{d \theta} \right)^2}

where:

\deqn{\frac{d H_T(\theta)}{d \theta} = 1 - \frac{d G_T(\theta)}{d \theta}}

\deqn{= 1 - \frac{\frac{d P(\theta)}{d \theta}}{(1 - P(\theta))^2} \left[ \frac{1}{T} \sum_{t=1}^{T} P_t(\theta) - P(\theta) \right]}

\deqn{+ \frac{1}{(1 - P(\theta))} \left[ \frac{1}{T} \sum_{t=1}^{T} \frac{d P_t(\theta)}{d \theta} - \frac{d P(\theta)}{d \theta} \right]}

\deqn{+ \frac{\frac{d P(\theta)}{d \theta}}{(1 - P(\theta))^3} \left[ \frac{1}{T^2} \sum_{t=1}^{T} P_t(\theta) (1 - P_t(\theta)) + \left( \frac{1}{T} \sum_{t=1}^{T} P_t(\theta) - P(\theta) \right)^2 \right]}

\deqn{+ \frac{1}{2 (1 - P(\theta))^2} \left[ \frac{1}{T^2} \sum_{t=1}^{T} \frac{d P_t(\theta)}{d \theta} - \frac{1}{T^2} \sum_{t=1}^{T} \frac{d^2 P_t(\theta)}{d \theta^2} \right]}

\deqn{+ 2 \left( \frac{1}{T} \sum_{t=1}^{T} P_t(\theta) - P(\theta) \right) \left( \frac{1}{T} \sum_{t=1}^{T} \frac{d P_t(\theta)}{d \theta} - \frac{d P(\theta)}{d \theta} \right)}

where \eqn{P(\theta) = 1-e^{-\theta}}, \eqn{P_t(\theta) = \frac{1-e^{-\theta}}{1-e^{-\theta t}}}, and \eqn{\lambda(\theta)} is the variance of the estimated paramter with bias in \code{\link{estimate_LDM_moments}}
}
\examples{
\dontrun{
Yt <- rnorm(25)
Xt <- Yt + 0.2 * (1:25)
rec_count(Xt)  # Number of records
res <- estimate_LDM_moments_unbias(Xt, variance = TRUE, scale = 1)
res$theta; res$variance
}
estimate_LDM_moments_unbias(X = c(0.428,1.311,2.023,2.882,2.096,-0.197,1.339,
1.748,1.418, 0.711, 1.999,3.598, 3.308, 3.942,2.025,3.282,4.043, 0.492, 4.639,
 1.408, 3.525, 5.398,  3.719, 3.741, 4.729))

# $theta
# [1] 0.3601306

# $variance
# [1] 0.3116952
}
