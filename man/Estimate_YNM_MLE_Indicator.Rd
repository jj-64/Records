% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Estimate YNM Parameter.R
\name{Estimate_YNM_MLE_Indicator}
\alias{Estimate_YNM_MLE_Indicator}
\title{Maximum Likelihood Estimation of Gamma Based on Indicator Series}
\usage{
Estimate_YNM_MLE_Indicator(
  X,
  variance = TRUE,
  approximate = FALSE,
  min = 1,
  max = 5,
  step = 0.001
)
}
\arguments{
\item{X}{Numeric vector representing the sequence.}

\item{variance}{Logical; if TRUE (default), compute the analytical or approximate variance.}

\item{approximate}{Logical; if TRUE, use the asymptotic approximation for the variance.}

\item{min}{Lower bound for the search range of \eqn{\gamma}. Default is 1.}

\item{max}{Upper bound for the search range of \eqn{\gamma}. Default is 5.}

\item{step}{Step size for the search grid. Default is 0.001.}
}
\value{
A list containing:
\item{gamma}{Estimated \eqn{\gamma} parameter.}
\item{variance}{Estimated variance (exact or approximate).}
}
\description{
Estimates the gamma (\eqn{\gamma}) parameter using the maximum likelihood
method based on the record indicator series, and optionally computes the
analytical or approximate variance.
}
\details{
The log-likelihood function is given by:
\deqn{
\log \ell(v = 1/\gamma) =
-N \log(1 - v)
+ (T - N)\log(v)
- \log(1 - v^T)
- \sum_{t=2}^{T} \delta_t \log(1 - v^{t-1})
}
where:
\itemize{
\item \eqn{v = 1 / \gamma},
\item \eqn{N} is the number of records,
\item \eqn{T} is the sequence length,
\item \eqn{\delta_t} are the record indicator variables.
}

The estimate \eqn{\hat{\gamma}} is found by setting the derivative
of the log-likelihood with respect to \eqn{v} to zero and solving numerically.

The \strong{exact Fisher information} for \eqn{\gamma} is:
\deqn{
I_T(\gamma) =
\frac{1}{\gamma^2 (\gamma - 1)^2} \sum_{t=1}^{T} P_t(\gamma)
+ \frac{1}{\gamma^2} (T - \sum_{t=1}^{T} P_t(\gamma))
- \frac{T (1 + \gamma^T (T - 1))}{\gamma^2 (\gamma^T - 1)^2}
- \sum_{t=2}^{T} \frac{(t-1)(1 + (t-2)\gamma^{t-1}) P_t(\gamma)}{\gamma^2 (\gamma^{t-1} -1)^2}
}

The asymptotic approximation for large \eqn{T} is:
\deqn{
\text{Var}(\hat{\gamma}) \approx \frac{1 - v}{T v^3}, \quad v = 1/\gamma
}
}
\examples{
set.seed(123)
X=YNM_series(T=50, gamma=1.2, dist="weibull", shape=2, scale=1)
X
[1] 0.3984360 0.9623867 1.5793358 0.5810157 1.1990188 1.1023248 0.7779932 1.7265598 1.6089237 1.8683241 1.9077715 1.1938959 2.1730424 1.8272045
[15] 1.7397198 1.5702099 2.1379330 1.8103224 1.9107890 2.0386229 1.9813020 2.6492839 2.3424281 2.4793168 2.4569918 2.0060300 2.2629934 2.3609622
[29] 2.1392445 2.1252441 3.2127646 2.2451416 2.6506264 2.7209208 2.5084019 2.8734849 3.1062846 2.5480120 2.6141440 2.5286307 2.5044793 2.8896440
[43] 2.7151352 2.8182222 3.3822301 3.7379543 3.1460838 3.1213262 3.1302067 3.1171138

Estimate_YNM_MLE_Indicator(X)
# $gamma
# [1] 1.183
#
# $variance
# [1] 0.006915017

Estimate_YNM_MLE_Indicator(X, approximate = TRUE)
# $gamma
# [1] 1.183

# $variance
# [1] 0.00512213
}
