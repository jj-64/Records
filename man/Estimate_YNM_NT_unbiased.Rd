% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Estimate YNM Parameter.R
\name{Estimate_YNM_NT_unbiased}
\alias{Estimate_YNM_NT_unbiased}
\title{Unbiased Estimation of Gamma Parameter based on number of records (with optional variance)}
\usage{
Estimate_YNM_NT_unbiased(X, variance = TRUE)
}
\arguments{
\item{X}{Numeric vector representing the observed sequence.}

\item{variance}{Logical; if TRUE (default), compute analytical variance.}
}
\value{
A list with:
\item{gamma}{Bias-corrected (unbiased) gamma estimate.}
\item{variance}{Analytical variance of the unbiased estimator (if computed).}
}
\description{
Computes \strong{bias-corrected} estimator of the (\eqn{\gamma}) parameter using a bias correction, correcting
\code{\link{Estimate_YNM_NT}}, and
optionally computes its analytical variance.
}
\details{
The unbiased estimator is given by:
\deqn{\hat{\gamma} = \hat{\gamma_{biased}} - \text{Bias}(\hat{\gamma_{biased}})}
The bias term is approximated as:
\deqn{
\text{Bias} =
\frac{h_T - P}{(1 - P)^2} +
\frac{1}{(1 - P)^3}
\left[
  \frac{h_T}{T}
  - \frac{1}{T^2}\sum_{t=1}^T \{ P_t^2 + (h_T - P)^2 \}
\right]
}
where:
\itemize{
\item \eqn{P_t = P_t(\gamma)} - record rate at time finite \eqn{t} \code{\link{rec_rate_YNM}},
\item \eqn{h_T = \frac{1}{T}\sum_{t=1}^T P_t},
\item \eqn{P = \lim_{t\to\infty} P_t(\gamma)} - record rate at time infinite \eqn{t} \code{\link{rec_rate_YNM}}.
}
\subsection{Variance Approximation}{

The analytical variance is obtained via the \strong{delta method}, as:
\deqn{
\text{Var}(\hat{\gamma}_u)
  \approx \lambda_\gamma
  \left( \frac{d H_T(\gamma)}{d \gamma} \right)^2,
}
where \eqn{\lambda_\gamma} is the variance of the biased estimator,
and the derivative term is expanded as:

\deqn{
\frac{d H_T(\gamma)}{d \gamma}
= 1
- \frac{2\, dP(\gamma)/d\gamma}{(1-P(\gamma))^3}
  \left[
    \frac{1}{T}\sum_{t=1}^{T} P_t(\gamma) - P(\gamma)
  \right]
+ \frac{1}{(1-P(\gamma))^2}
  \left[
    \frac{1}{T}\sum_{t=1}^{T} \frac{dP_t(\gamma)}{d\gamma} - \frac{dP(\gamma)}{d\gamma}
  \right]
}
\deqn{
+ \frac{3\, dP(\gamma)/d\gamma}{(1-P(\gamma))^4}
  \left[
    \frac{1}{T^2}\sum_{t=1}^{T} P_t(\gamma)(1-P_t(\gamma))
    + \left(
      \frac{1}{T}\sum_{t=1}^{T} P_t(\gamma) - P(\gamma)
    \right)^2
  \right]
+ \frac{1}{(1-P(\gamma))^3}
  \left[
    \frac{1}{T^2}\sum_{t=1}^{T} \frac{dP_t(\gamma)}{d\gamma}
    - \frac{1}{T^2}\sum_{t=1}^{T} \frac{d^2P_t(\gamma)}{d\gamma^2}
  \right]
+ 2
\left(
  \frac{1}{T}\sum_{t=1}^{T} P_t(\gamma) - P(\gamma)
\right)
\left(
  \frac{1}{T}\sum_{t=1}^{T} \frac{dP_t(\gamma)}{d\gamma} - \frac{dP(\gamma)}{d\gamma}
\right).
}
}
}
\examples{
set.seed(123)
X=YNM_series(T=50, gamma=1.2, dist="weibull", shape=2, scale=1)
X
[1] 0.3984360 0.9623867 1.5793358 0.5810157 1.1990188 1.1023248 0.7779932 1.7265598 1.6089237 1.8683241 1.9077715 1.1938959 2.1730424 1.8272045
[15] 1.7397198 1.5702099 2.1379330 1.8103224 1.9107890 2.0386229 1.9813020 2.6492839 2.3424281 2.4793168 2.4569918 2.0060300 2.2629934 2.3609622
[29] 2.1392445 2.1252441 3.2127646 2.2451416 2.6506264 2.7209208 2.5084019 2.8734849 3.1062846 2.5480120 2.6141440 2.5286307 2.5044793 2.8896440
[43] 2.7151352 2.8182222 3.3822301 3.7379543 3.1460838 3.1213262 3.1302067 3.1171138

Estimate_YNM_NT_unbiased(X)
# $gamma
# [1] 1.212979
#
# $variance
# [1] 0.2997593
}
