% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Test_YNM.R
\name{Test_YNM_Geom}
\alias{Test_YNM_Geom}
\title{Test for YNM–Nevzorov Geometric Record Gaps}
\usage{
Test_YNM_Geom(X, alpha = 0.05, K = NULL, warmup = NULL)
}
\arguments{
\item{X}{Numeric vector of observations.}

\item{alpha}{Numeric, significance level (default = 0.05).}

\item{K}{Integer, number of categories for chi-squared grouping.
If NULL, defaults to \eqn{min(4, length(gaps))}.}

\item{warmup}{Integer, number of initial gaps to discard (default = NULL).}
}
\value{
A list with elements:
\item{obs_counts}{Observed counts per category.}
\item{exp_counts}{Expected counts per category under fitted geometric law.}
\item{stat}{Chi-squared test statistic.}
\item{df}{Degrees of freedom.}
\item{p_value}{P-value of the chi-squared test.}
\item{p_hat}{Estimated geometric parameter.}
\item{gamma_hat}{Estimated YNM parameter \eqn{\gamma}.}
\item{v_gamma_hat}{Estimated variance of \eqn{\hat{\gamma}}.}
\item{CL}{Confidence interval for \eqn{\gamma}.}
\item{decision}{Decision: "YNM" if not rejected, "NO" otherwise.}
}
\description{
Performs a goodness-of-fit test for the YNM–Nevzorov model by examining
the distribution of record time gaps in a sequence of observations.
The procedure estimates the geometric parameter, computes a chi-squared
statistic on grouped frequencies, and evaluates whether the observed record
gaps are consistent with a geometric distribution.
}
\details{
Let \eqn{G_i} denote the observed record gaps. Under the YNM-Nevzorov
model, the gaps are approximately geometrically distributed with parameter
\eqn{\hat{p} = 1 / \bar{G}}. The test proceeds as follows:
\enumerate{
\item Remove warm-up gaps (if NULL, 30\% of gaps are removed)
\item Estimate \eqn{p} and the implied \eqn{\hat{\gamma} = 1 / (1 - \hat{p})}.
\item Compute expected frequencies for the first \eqn{K-1} categories and
group all larger gaps into the \eqn{K}-th bin.
\item Form the Pearson chi-squared statistic:
\deqn{ \chi^2 = \sum_{k=1}^K \frac{(O_k - E_k)^2}{E_k}, }
with \eqn{df = (K - 1) - 1} degrees of freedom (adjusted for the
estimated parameter).
\item Return decision "YNM" if the null hypothesis of geometric gaps
is not rejected, and "NO" otherwise.
}

A confidence interval for {\eqn{\gamma}} is also computed using a
normal approximation:
\deqn{ \text{Var}(\hat{\gamma}) = \frac{\hat{\gamma} (\hat{\gamma} - 1)^2}{n}. }
}
\examples{
set.seed(123)
X <- YNM_series_Gumbel(T = 50, gamma = 1.2)
Test_YNM_Geom(X, alpha = 0.05, K = 4, warmup=2)

# $obs_counts
# [1] 3 3 1 4

# $exp_counts

# [1] 2.69 2.03 1.53 4.74

# $stat
# [1] 0.8008871

# $df
# [1] 2

# $p_value
# [1] 0.6700228

# $p_hat
# [1] 0.2444444

# $gamma_hat
# [1] 1.323529

# $v_gamma_hat
# [1] 0.01259414

# $CL
# [1] 1.138938 1.508121

# $decision
# [1] "YNM"
}
