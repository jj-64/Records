% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Likelihood V_Xt_Frechet.R
\name{V_Xt_Frechet_LDM_scale}
\alias{V_Xt_Frechet_LDM_scale}
\title{Variance of A:1/Scale LogL Estimator for Frechet LDM using full dataset}
\usage{
V_Xt_Frechet_LDM_scale(x, params)
}
\arguments{
\item{x}{Numeric vector of observations.}

\item{params}{Numeric vector of three values:  drift parameter \eqn{\theta > 0};  scale parameter \eqn{A > 0};  shape parameter \eqn{a > 0}.}
}
\value{
Numeric, variance of A:1/Scale estimator.
}
\description{
Variance of A:1/Scale LogL Estimator for Frechet LDM using full dataset
}
\details{
Estimators are obtained by maximizing the Log-Likelihood based on full dataset \eqn{X_t} \code{\link{Likelihood_Xt_Frechet_LDM}}
The Fisher information is given by:
\deqn{ I(A) = - (a+1) a A^{-a-2} \sum_{t=1}^{T} x^{-a} + \frac{a T}{A^2} }
}
\examples{
Xt = LDM_series_Frechet(T=25,theta=0.2, shape=2, scale=1)
Xt
[1] 1.252804 1.465630 2.622688 2.061684 2.723450 4.932948 2.717134 2.368716
[9] 2.487995 2.687706 3.656084 4.580848 4.215754 4.284083 4.110642 3.851272
[17] 4.031203 5.637333 5.372408 4.897131 5.071756 5.137329 5.698935 5.624777
[25] 9.041731
 # Set parameter bounds: Lower and Upper bounds for gAa[1], gAa[2], and gAa[3]
lower_bounds <- c(0.001, 0.001, 0.001)
upper_bounds <- c(5,20,20)  # Example: Bound gAa[1] by min(R/L)
start_values <- c(0.001, 0.001, 0.001)

Log_L= function(gAa){ x=Xt; T=T; return(-Likelihood_Xt_Frechet_LDM(T=T, x=Xt, gAa)) }

## Run optimization using optim with L-BFGS-B method
MLE_C <- optim(par = start_values,           # Starting values for gAa
              fn = Log_L,        # The likelihood function
              method = "L-BFGS-B",
              lower = lower_bounds,         # Lower bounds
              upper = upper_bounds)$par
MLE_C
[1] 0.1915248 0.0010000 2.8231442  #theta, A, a
### Estimate A correctly
MLE_C[2] = eq_scale(a=MLE_C[3],Xt,theta=MLE_C[1])
MLE_C
0.1915248 0.9054421 2.8231442

## Alternatively, we can obtain accurate estimates, using first-order derivatives
Likelihood_Xt_Frechet_LDM_OptSolve(x=Xt)
      theta           A           a        logL
   0.1915428   0.9056486   2.8225928 -21.5907410

V= V_Xt_Frechet_LDM_scale(x=Xt, g=MLE_C[1], A= MLE_C[2], a= MLE_C[3])
V
[1] 0.004114482

#Confidence interval
bounds(value = MLE_C[2], z = 1.96 , variance = V)
[1]   0.7797194 1.0311647
}
