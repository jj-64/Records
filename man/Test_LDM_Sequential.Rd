% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Test_LDM.R
\name{Test_LDM_Sequential}
\alias{Test_LDM_Sequential}
\alias{Test_LDM_Sen_stage1}
\alias{Test_LDM_Sen_stage2}
\title{Sequential Test for the Linear Drift Model (LDM)}
\usage{
Test_LDM_Sequential(X, alpha = 0.05)

Test_LDM_Sen_stage1(X, alpha = 0.05, pooled = FALSE)

Test_LDM_Sen_stage2(stage1, alpha = 0.05)
}
\arguments{
\item{X}{Numeric vector of observations.}

\item{alpha}{Numeric, significance level (default = 0.05).}

\item{pooled}{Logical, if \code{TRUE}, pooled variance across blocks is used
in stage 1 for the noise variance estimation. Otherwise, variance is estimated directly
from residuals (default = \code{FALSE}).}
}
\value{
A list with results from both stages:
\describe{
\item{block_size}{Size of each partitioned block.}
\item{means}{Block means.}
\item{slopes}{Estimated block-to-block slopes.}
\item{var_x}{Estimated variance of the noise process.}
\item{Z}{Test statistic from stage 1.}
\item{Var_Z}{Estimated variance of \code{Z}.}
\item{stat}{Standardized stage 1 test statistic.}
\item{p_value}{p_value of the stage 1 test.}
\item{decision}{Decision of stage 1: \code{"Sameslope"} or \code{"NO"}.}
\item{z_A}{Stage 2 standardized slope for first block comparison.}
\item{z_B}{Stage 2 standardized slope for third block comparison.}
\item{slope_SD}{Estimated standard deviation of slope differences (stage 2).}
\item{decision}{Final decision: \code{"LDM"} or \code{"NO"}.}
}
}
\description{
Implements a two-stage sequential testing procedure (based on Åžen-type tests)
to detect the presence of a linear drift in a time series.
}
\details{
The procedure partitions the data into blocks and checks whether block means
and slopes are consistent with a monotonic non-zero linear drift. If stage 1 accepts, stage 2
refines the decision by testing slope significance across partitions.

Stage 1 partitions the series into 3 blocks of size \eqn{m = \lfloor n/3 \rfloor}.
It computes block means and slopes and tests whether the central block mean
aligns with the average of the first and third block means:
\deqn{ Z = \frac{2 \bar{X}_2 - \bar{X}_1 - \bar{X}_3}{m} }
with variance estimated either via pooling (\code{pooled=TRUE}) or directly.

Stage 2 tests whether the slopes between blocks are significantly different
from zero:
\deqn{ z_A = \frac{s_1}{\hat{\sigma}_s}, \quad z_B = \frac{s_2}{\hat{\sigma}_s} }
where \eqn{\hat{\sigma}_s = \sqrt{2 \hat{\sigma}_y / m^3}} and \eqn{Y} is the underlying distribution of the LDM process.

The procedure stops at stage 1 if no drift is detected.
}
\examples{
set.seed(123)
t <- 1:60
X <- 0.1 * t + rnorm(60, sd = 1)
Test_LDM_Sequential(X, alpha = 0.05)


}
